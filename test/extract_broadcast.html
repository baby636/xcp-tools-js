<html>
<head>
    <script src="../js/jquery.min.js"></script>
    <script src="../js/bitcore/bitcore.min.js"></script>
    <script src="../js/mnemonic.js"></script>
    <script src="../js/xcp-js/pushtx.js"></script>
    <script src="../js/xcp-js/transactions.js"></script>
    <script src="../js/xcp-js/rc4.js"></script>
    <script src="../js/xcp-js/convert-type.js"></script>
    <script src="../js/xcp-js/decode.js"></script>
    
<script>
 
var bitcore = require('bitcore');
   
$( document ).ready(function() {
          
    $("#getdatabutton").click(function(){
        
        var tx_id = $("#tx_id").val();

//      Send Transaction
        
//        get_xcp_encoded(tx_id, function(utxo_hash, data_chunk){
//            $("#arc").html(data_chunk);
//            var asset = data_chunk.substring(42, 26);
//            var amount = data_chunk.substring(58, 42);
//            var asset_dec = parseInt(asset, 16);
//            var amount_dec = parseInt(amount, 16) / 100000000;
//            $("#assetid").html(asset_dec);
//            $("#assetamt").html(amount_dec);
//    
//        });
        
        
        get_xcp_encoded(tx_id, function(utxo_hash, data_chunk){
            $("#arc").html(data_chunk);
            var data = data_chunk.substring(60, 26);
            var message_hex = data_chunk.substring(124, 60);
            var timestamp_hex = data.substring(0,8);
            
            
            
            //var amount_dec = parseInt(amount, 16) / 100000000;
            
            var message = hex2bin(message_hex);
            var timestamp = parseInt(timestamp_hex, 16);
            
            
            $("#assetid").html(data);
            $("#timestamp").html(timestamp);
            $("#broadcasttext").html(message);
    
        });
    });

});
    

</script>
</head>
<body>
    <h1 style="margin-top: 20px;">Extract XCP Asset Send Transaction Data (multi-sig encoded only)</h1>
    <div style="margin-top: 50px;">Bitcoin Tx Hash</div>
    <input type="text" id="tx_id" label="Tx Hash" value="6c6ebf5a19be3601a9e10a4722e73ae5bfbcbce0f9917e57dc71cc3305bd5741" required>

    <div style="margin-top: 20px;">
    <input type="button" id="getdatabutton" value="Get XCP Data">
    
    
    
    <!--
    <div style="margin-top: 50px;">Hashed Data: <span id="arc"></span></div>
    
    <div style="margin-top: 20px;">Asset ID: <span id="assetid"></span></div>
        
    <div style="margin-top: 20px;">Asset Amount: <span id="assetamt"></span></div>
        
    -->    
        
    <div style="margin-top: 50px;">Hashed Data: <span id="arc"></span></div>
    
    <div style="margin-top: 20px;">Broadcast Data: <span id="assetid"></span></div>
        
    <div style="margin-top: 20px;">Timestamp: <span id="timestamp"></span></div>
        
    <div style="margin-top: 20px;">Text: <span id="broadcasttext"></span></div>

</body>
</html>
